from flask import Flask, request, jsonify

app = Flask(__name__)

# --- SIMPLE CHATBOT LOGIC (no API required) ---
def get_bot_reply(user_msg):
    # You can customize responses here
    if "diabetes" in user_msg.lower():
        return "Diabetes is a condition where blood sugar levels stay high due to lack of insulin."
    elif "fever" in user_msg.lower():
        return "Fever is usually a sign of infection. Keep hydrated and monitor temperature."
    else:
        return "I'm your medical education bot. Ask me anything about health topics!"

# --- ROUTES ---
@app.route("/")
def home():
    return """
    <html>
    <head>
        <title>Simple Chatbot</title>
    </head>
    <body>
        <h2>Patient Education Chatbot</h2>
        <input id='msg' placeholder='Type your question'>
        <button onclick='send()'>Send</button>
        <div id='chat'></div>

        <script>
            async function send() {
                let message = document.getElementById("msg").value;

                let response = await fetch("/chat", {
                    method: "POST",
                    headers: {"Content-Type": "application/json"},
                    body: JSON.stringify({message: message})
                });

                let data = await response.json();

                document.getElementById("chat").innerHTML += 
                    "<p><b>You:</b> " + message + "</p>" +
                    "<p><b>Bot:</b> " + data.response + "</p>";
            }
        </script>
    </body>
    </html>
    """

@app.route("/chat", methods=["POST"])
def chat():
    user_msg = request.json.get("message")
    bot_reply = get_bot_reply(user_msg)
    return jsonify({"response": bot_reply})

if __name__ == "__main__":
    app.run(debug=True)
